Some weights of the model checkpoint at allenai/longformer-base-4096 were not used when initializing LongformerModel: ['lm_head.layer_norm.bias', 'lm_head.bias', 'lm_head.dense.bias', 'lm_head.decoder.weight', 'lm_head.layer_norm.weight', 'lm_head.dense.weight']
- This IS expected if you are initializing LongformerModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LongformerModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at emilyalsentzer/Bio_ClinicalBERT were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.weight', 'cls.predictions.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
ehr loaded
cxr loaded
==> training
running for fusion_type fused_ehr
0
starting val epoch 0
val [0000 / 0050] validation loss: 	0.78205
checkpoint
starting train epoch 0
 epoch [0000 / 0050] [0009/280] eta: 0 Days 11:15:19       lr: 	1.0000E-04 loss: 	0.49035 loss align 0.0000
 epoch [0000 / 0050] [0109/280] eta: 0 Days 1:44:42        lr: 	1.0000E-04 loss: 	0.45288 loss align 0.0000
 epoch [0000 / 0050] [0209/280] eta: 0 Days 1:17:42        lr: 	1.0000E-04 loss: 	0.42018 loss align 0.0000
1
starting val epoch 1
val [0001 / 0050] validation loss: 	0.38678
checkpoint
starting train epoch 1
 epoch [0001 / 0050] [0009/280] eta: 0 Days 1:18:33        lr: 	1.0000E-04 loss: 	0.45776 loss align 0.0000
 epoch [0001 / 0050] [0109/280] eta: 0 Days 1:10:21        lr: 	1.0000E-04 loss: 	0.37339 loss align 0.0000
 epoch [0001 / 0050] [0209/280] eta: 0 Days 1:6:25         lr: 	1.0000E-04 loss: 	0.36354 loss align 0.0000
2
starting val epoch 2
val [0002 / 0050] validation loss: 	0.41189
checkpoint
starting train epoch 2
 epoch [0002 / 0050] [0009/280] eta: 0 Days 1:8:17         lr: 	1.0000E-04 loss: 	0.47410 loss align 0.0000
 epoch [0002 / 0050] [0109/280] eta: 0 Days 1:5:39         lr: 	1.0000E-04 loss: 	0.34584 loss align 0.0000
 epoch [0002 / 0050] [0209/280] eta: 0 Days 1:2:31         lr: 	1.0000E-04 loss: 	0.34897 loss align 0.0000
3
starting val epoch 3
val [0003 / 0050] validation loss: 	0.34685
checkpoint
starting train epoch 3
 epoch [0003 / 0050] [0009/280] eta: 0 Days 1:3:51         lr: 	1.0000E-04 loss: 	0.39718 loss align 0.0000
 epoch [0003 / 0050] [0109/280] eta: 0 Days 1:1:53         lr: 	1.0000E-04 loss: 	0.34561 loss align 0.0000
 epoch [0003 / 0050] [0209/280] eta: 0 Days 1:0:16         lr: 	1.0000E-04 loss: 	0.34430 loss align 0.0000
4
starting val epoch 4
val [0004 / 0050] validation loss: 	0.36325
starting train epoch 4
 epoch [0004 / 0050] [0009/280] eta: 0 Days 1:0:36         lr: 	1.0000E-04 loss: 	0.37493 loss align 0.0000
 epoch [0004 / 0050] [0109/280] eta: 0 Days 0:58:52        lr: 	1.0000E-04 loss: 	0.31818 loss align 0.0000
 epoch [0004 / 0050] [0209/280] eta: 0 Days 0:57:4         lr: 	1.0000E-04 loss: 	0.32587 loss align 0.0000
5
starting val epoch 5
val [0005 / 0050] validation loss: 	0.33579
checkpoint
starting train epoch 5
 epoch [0005 / 0050] [0009/280] eta: 0 Days 0:57:32        lr: 	1.0000E-04 loss: 	0.33220 loss align 0.0000
 epoch [0005 / 0050] [0109/280] eta: 0 Days 0:55:55        lr: 	1.0000E-04 loss: 	0.32889 loss align 0.0000
 epoch [0005 / 0050] [0209/280] eta: 0 Days 0:54:30        lr: 	1.0000E-04 loss: 	0.31554 loss align 0.0000
6
starting val epoch 6
val [0006 / 0050] validation loss: 	0.35073
checkpoint
starting train epoch 6
 epoch [0006 / 0050] [0009/280] eta: 0 Days 0:54:56        lr: 	1.0000E-04 loss: 	0.31677 loss align 0.0000
 epoch [0006 / 0050] [0109/280] eta: 0 Days 0:53:41        lr: 	1.0000E-04 loss: 	0.31164 loss align 0.0000
 epoch [0006 / 0050] [0209/280] eta: 0 Days 0:52:47        lr: 	1.0000E-04 loss: 	0.31408 loss align 0.0000
7
starting val epoch 7
val [0007 / 0050] validation loss: 	0.34332
starting train epoch 7
 epoch [0007 / 0050] [0009/280] eta: 0 Days 0:53:3         lr: 	1.0000E-04 loss: 	0.36491 loss align 0.0000
 epoch [0007 / 0050] [0109/280] eta: 0 Days 0:52:2         lr: 	1.0000E-04 loss: 	0.29928 loss align 0.0000
 epoch [0007 / 0050] [0209/280] eta: 0 Days 0:51:2         lr: 	1.0000E-04 loss: 	0.29042 loss align 0.0000
8
starting val epoch 8
val [0008 / 0050] validation loss: 	0.34707
starting train epoch 8
 epoch [0008 / 0050] [0009/280] eta: 0 Days 0:51:7         lr: 	1.0000E-04 loss: 	0.23495 loss align 0.0000
 epoch [0008 / 0050] [0109/280] eta: 0 Days 0:50:8         lr: 	1.0000E-04 loss: 	0.31994 loss align 0.0000
 epoch [0008 / 0050] [0209/280] eta: 0 Days 0:49:18        lr: 	1.0000E-04 loss: 	0.30283 loss align 0.0000
9
starting val epoch 9
val [0009 / 0050] validation loss: 	0.33241
checkpoint
starting train epoch 9
 epoch [0009 / 0050] [0009/280] eta: 0 Days 0:49:29        lr: 	1.0000E-04 loss: 	0.27886 loss align 0.0000
 epoch [0009 / 0050] [0109/280] eta: 0 Days 0:48:37        lr: 	1.0000E-04 loss: 	0.28214 loss align 0.0000
 epoch [0009 / 0050] [0209/280] eta: 0 Days 0:47:49        lr: 	1.0000E-04 loss: 	0.29150 loss align 0.0000
10
starting val epoch 10
val [0010 / 0050] validation loss: 	0.35739
starting train epoch 10
 epoch [0010 / 0050] [0009/280] eta: 0 Days 0:47:48        lr: 	1.0000E-04 loss: 	0.33973 loss align 0.0000
 epoch [0010 / 0050] [0109/280] eta: 0 Days 0:47:2         lr: 	1.0000E-04 loss: 	0.27154 loss align 0.0000
 epoch [0010 / 0050] [0209/280] eta: 0 Days 0:46:21        lr: 	1.0000E-04 loss: 	0.27695 loss align 0.0000
11
starting val epoch 11
val [0011 / 0050] validation loss: 	0.37093
starting train epoch 11
 epoch [0011 / 0050] [0009/280] eta: 0 Days 0:46:18        lr: 	1.0000E-04 loss: 	0.31490 loss align 0.0000
 epoch [0011 / 0050] [0109/280] eta: 0 Days 0:45:38        lr: 	1.0000E-04 loss: 	0.25614 loss align 0.0000
 epoch [0011 / 0050] [0209/280] eta: 0 Days 0:44:57        lr: 	1.0000E-04 loss: 	0.26781 loss align 0.0000
12
starting val epoch 12
val [0012 / 0050] validation loss: 	0.37161
starting train epoch 12
 epoch [0012 / 0050] [0009/280] eta: 0 Days 0:45:2         lr: 	1.0000E-04 loss: 	0.30951 loss align 0.0000
 epoch [0012 / 0050] [0109/280] eta: 0 Days 0:44:19        lr: 	1.0000E-04 loss: 	0.26537 loss align 0.0000
 epoch [0012 / 0050] [0209/280] eta: 0 Days 0:43:37        lr: 	1.0000E-04 loss: 	0.26406 loss align 0.0000
13
starting val epoch 13
val [0013 / 0050] validation loss: 	0.39633
checkpoint
starting train epoch 13
 epoch [0013 / 0050] [0009/280] eta: 0 Days 0:43:44        lr: 	1.0000E-04 loss: 	0.33594 loss align 0.0000
 epoch [0013 / 0050] [0109/280] eta: 0 Days 0:43:6         lr: 	1.0000E-04 loss: 	0.24781 loss align 0.0000
 epoch [0013 / 0050] [0209/280] eta: 0 Days 0:42:29        lr: 	1.0000E-04 loss: 	0.25596 loss align 0.0000
14
starting val epoch 14
val [0014 / 0050] validation loss: 	0.36341
starting train epoch 14
 epoch [0014 / 0050] [0009/280] eta: 0 Days 0:42:23        lr: 	1.0000E-04 loss: 	0.25050 loss align 0.0000
 epoch [0014 / 0050] [0109/280] eta: 0 Days 0:41:46        lr: 	1.0000E-04 loss: 	0.24941 loss align 0.0000
 epoch [0014 / 0050] [0209/280] eta: 0 Days 0:41:8         lr: 	1.0000E-04 loss: 	0.25037 loss align 0.0000
15
starting val epoch 15
val [0015 / 0050] validation loss: 	0.39752
starting train epoch 15
 epoch [0015 / 0050] [0009/280] eta: 0 Days 0:41:9         lr: 	1.0000E-04 loss: 	0.15972 loss align 0.0000
 epoch [0015 / 0050] [0109/280] eta: 0 Days 0:40:35        lr: 	1.0000E-04 loss: 	0.22240 loss align 0.0000
 epoch [0015 / 0050] [0209/280] eta: 0 Days 0:40:8         lr: 	1.0000E-04 loss: 	0.22486 loss align 0.0000
16
starting val epoch 16
val [0016 / 0050] validation loss: 	0.38024
checkpoint
starting train epoch 16
 epoch [0016 / 0050] [0009/280] eta: 0 Days 0:40:9         lr: 	1.0000E-04 loss: 	0.22924 loss align 0.0000
 epoch [0016 / 0050] [0109/280] eta: 0 Days 0:39:35        lr: 	1.0000E-04 loss: 	0.20747 loss align 0.0000
 epoch [0016 / 0050] [0209/280] eta: 0 Days 0:39:0         lr: 	1.0000E-04 loss: 	0.21830 loss align 0.0000
17
starting val epoch 17
val [0017 / 0050] validation loss: 	0.45255
starting train epoch 17
 epoch [0017 / 0050] [0009/280] eta: 0 Days 0:38:51        lr: 	1.0000E-04 loss: 	0.16887 loss align 0.0000
 epoch [0017 / 0050] [0109/280] eta: 0 Days 0:38:15        lr: 	1.0000E-04 loss: 	0.21278 loss align 0.0000
 epoch [0017 / 0050] [0209/280] eta: 0 Days 0:37:40        lr: 	1.0000E-04 loss: 	0.21826 loss align 0.0000
18
starting val epoch 18
val [0018 / 0050] validation loss: 	0.39890
starting train epoch 18
 epoch [0018 / 0050] [0009/280] eta: 0 Days 0:37:29        lr: 	1.0000E-04 loss: 	0.26098 loss align 0.0000
 epoch [0018 / 0050] [0109/280] eta: 0 Days 0:36:58        lr: 	1.0000E-04 loss: 	0.19672 loss align 0.0000
 epoch [0018 / 0050] [0209/280] eta: 0 Days 0:36:28        lr: 	1.0000E-04 loss: 	0.21173 loss align 0.0000
19
starting val epoch 19
val [0019 / 0050] validation loss: 	0.41959
starting train epoch 19
 epoch [0019 / 0050] [0009/280] eta: 0 Days 0:36:16        lr: 	1.0000E-04 loss: 	0.21294 loss align 0.0000
 epoch [0019 / 0050] [0109/280] eta: 0 Days 0:35:42        lr: 	1.0000E-04 loss: 	0.18750 loss align 0.0000
 epoch [0019 / 0050] [0209/280] eta: 0 Days 0:35:11        lr: 	1.0000E-04 loss: 	0.18770 loss align 0.0000
20
starting val epoch 20
val [0020 / 0050] validation loss: 	0.42976
starting train epoch 20
 epoch [0020 / 0050] [0009/280] eta: 0 Days 0:35:0         lr: 	1.0000E-04 loss: 	0.17877 loss align 0.0000
 epoch [0020 / 0050] [0109/280] eta: 0 Days 0:34:31        lr: 	1.0000E-04 loss: 	0.17075 loss align 0.0000
 epoch [0020 / 0050] [0209/280] eta: 0 Days 0:33:58        lr: 	1.0000E-04 loss: 	0.17861 loss align 0.0000
21
starting val epoch 21
val [0021 / 0050] validation loss: 	0.51149
starting train epoch 21
 epoch [0021 / 0050] [0009/280] eta: 0 Days 0:33:46        lr: 	1.0000E-04 loss: 	0.19304 loss align 0.0000
 epoch [0021 / 0050] [0109/280] eta: 0 Days 0:33:19        lr: 	1.0000E-04 loss: 	0.16230 loss align 0.0000
 epoch [0021 / 0050] [0209/280] eta: 0 Days 0:32:50        lr: 	1.0000E-04 loss: 	0.15850 loss align 0.0000
22
starting val epoch 22
val [0022 / 0050] validation loss: 	0.66916
starting train epoch 22
 epoch [0022 / 0050] [0009/280] eta: 0 Days 0:32:37        lr: 	1.0000E-04 loss: 	0.09741 loss align 0.0000
 epoch [0022 / 0050] [0109/280] eta: 0 Days 0:32:6         lr: 	1.0000E-04 loss: 	0.14788 loss align 0.0000
 epoch [0022 / 0050] [0209/280] eta: 0 Days 0:31:38        lr: 	1.0000E-04 loss: 	0.15985 loss align 0.0000
23
starting val epoch 23
val [0023 / 0050] validation loss: 	0.48162
starting train epoch 23
 epoch [0023 / 0050] [0009/280] eta: 0 Days 0:31:24        lr: 	1.0000E-04 loss: 	0.11126 loss align 0.0000
 epoch [0023 / 0050] [0109/280] eta: 0 Days 0:30:58        lr: 	1.0000E-04 loss: 	0.15064 loss align 0.0000
 epoch [0023 / 0050] [0209/280] eta: 0 Days 0:30:31        lr: 	1.0000E-04 loss: 	0.14972 loss align 0.0000
24
starting val epoch 24
val [0024 / 0050] validation loss: 	0.52374
starting train epoch 24
 epoch [0024 / 0050] [0009/280] eta: 0 Days 0:30:18        lr: 	1.0000E-04 loss: 	0.13652 loss align 0.0000
 epoch [0024 / 0050] [0109/280] eta: 0 Days 0:29:47        lr: 	1.0000E-04 loss: 	0.13676 loss align 0.0000
 epoch [0024 / 0050] [0209/280] eta: 0 Days 0:29:19        lr: 	1.0000E-04 loss: 	0.13981 loss align 0.0000
25
starting val epoch 25
val [0025 / 0050] validation loss: 	0.53752
starting train epoch 25
 epoch [0025 / 0050] [0009/280] eta: 0 Days 0:29:7         lr: 	1.0000E-04 loss: 	0.17987 loss align 0.0000
 epoch [0025 / 0050] [0109/280] eta: 0 Days 0:28:37        lr: 	1.0000E-04 loss: 	0.15912 loss align 0.0000
 epoch [0025 / 0050] [0209/280] eta: 0 Days 0:28:8         lr: 	1.0000E-04 loss: 	0.15099 loss align 0.0000
26
starting val epoch 26
val [0026 / 0050] validation loss: 	0.65602
starting train epoch 26
 epoch [0026 / 0050] [0009/280] eta: 0 Days 0:27:54        lr: 	1.0000E-04 loss: 	0.08607 loss align 0.0000
 epoch [0026 / 0050] [0109/280] eta: 0 Days 0:27:29        lr: 	1.0000E-04 loss: 	0.12552 loss align 0.0000
 epoch [0026 / 0050] [0209/280] eta: 0 Days 0:27:1         lr: 	1.0000E-04 loss: 	0.12885 loss align 0.0000
27
starting val epoch 27
val [0027 / 0050] validation loss: 	0.60460
starting train epoch 27
 epoch [0027 / 0050] [0009/280] eta: 0 Days 0:26:47        lr: 	1.0000E-04 loss: 	0.11982 loss align 0.0000
 epoch [0027 / 0050] [0109/280] eta: 0 Days 0:26:17        lr: 	1.0000E-04 loss: 	0.10788 loss align 0.0000
 epoch [0027 / 0050] [0209/280] eta: 0 Days 0:25:49        lr: 	1.0000E-04 loss: 	0.12993 loss align 0.0000
28
starting val epoch 28
val [0028 / 0050] validation loss: 	0.63983
starting train epoch 28
 epoch [0028 / 0050] [0009/280] eta: 0 Days 0:25:33        lr: 	1.0000E-04 loss: 	0.12102 loss align 0.0000
 epoch [0028 / 0050] [0109/280] eta: 0 Days 0:25:6         lr: 	1.0000E-04 loss: 	0.13197 loss align 0.0000
 epoch [0028 / 0050] [0209/280] eta: 0 Days 0:24:38        lr: 	1.0000E-04 loss: 	0.13014 loss align 0.0000
29
starting val epoch 29
val [0029 / 0050] validation loss: 	0.72539
starting train epoch 29
 epoch [0029 / 0050] [0009/280] eta: 0 Days 0:24:22        lr: 	1.0000E-04 loss: 	0.15484 loss align 0.0000
 epoch [0029 / 0050] [0109/280] eta: 0 Days 0:23:55        lr: 	1.0000E-04 loss: 	0.14032 loss align 0.0000
 epoch [0029 / 0050] [0209/280] eta: 0 Days 0:23:30        lr: 	1.0000E-04 loss: 	0.12525 loss align 0.0000
30
starting val epoch 30
val [0030 / 0050] validation loss: 	0.61531
starting train epoch 30
 epoch [0030 / 0050] [0009/280] eta: 0 Days 0:23:14        lr: 	1.0000E-04 loss: 	0.11331 loss align 0.0000
 epoch [0030 / 0050] [0109/280] eta: 0 Days 0:22:46        lr: 	1.0000E-04 loss: 	0.11764 loss align 0.0000
 epoch [0030 / 0050] [0209/280] eta: 0 Days 0:22:19        lr: 	1.0000E-04 loss: 	0.10936 loss align 0.0000
31
starting val epoch 31
val [0031 / 0050] validation loss: 	0.63345
starting val epoch 0
val [0000 / 0050] validation loss: 	0.40399
Acute and unspecified renal failure                                                        & 0.804(0.838, 0.770) & 0.447 (0.528, 0.375)
fused_ehr test  0   best mean auc :0.804 mean auprc 0.447
                    CI AUROC (0.770, 0.838) CI AUPRC (0.375, 0.528)
                     AUROC accute 0.804 mixed 0.804 chronic 0.804
                     AUROC accute CI (0.770, 0.838) mixed (0.770 , 0.838) chronic (0.770, 0.838)
                     AUPRC accute  0.447 mixed 0.447 chronic 0.447
                     AUPRC accute CI  (0.375, 0.528) mixed (0.375,  0.528) chronic (0.375, 0.528)