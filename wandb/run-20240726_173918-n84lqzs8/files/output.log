Some weights of the model checkpoint at allenai/longformer-base-4096 were not used when initializing LongformerModel: ['lm_head.decoder.weight', 'lm_head.bias', 'lm_head.layer_norm.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight']
- This IS expected if you are initializing LongformerModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LongformerModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at emilyalsentzer/Bio_ClinicalBERT were not used when initializing BertModel: ['cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
ehr loaded
cxr loaded
==> training
running for fusion_type fused_ehr
0
starting val epoch 0
val [0000 / 0050] validation loss: 	0.78205
checkpoint
starting train epoch 0
 epoch [0000 / 0050] [0009/280] eta: 0 Days 14:16:43       lr: 	1.0000E-03 loss: 	0.75577 loss align 0.0000
 epoch [0000 / 0050] [0109/280] eta: 0 Days 2:7:18         lr: 	1.0000E-03 loss: 	0.48027 loss align 0.0000
 epoch [0000 / 0050] [0209/280] eta: 0 Days 1:33:17        lr: 	1.0000E-03 loss: 	0.45401 loss align 0.0000
1
starting val epoch 1
val [0001 / 0050] validation loss: 	0.42437
starting train epoch 1
 epoch [0001 / 0050] [0009/280] eta: 0 Days 1:31:29        lr: 	1.0000E-03 loss: 	0.48441 loss align 0.0000
 epoch [0001 / 0050] [0109/280] eta: 0 Days 1:20:47        lr: 	1.0000E-03 loss: 	0.43053 loss align 0.0000
 epoch [0001 / 0050] [0209/280] eta: 0 Days 1:14:19        lr: 	1.0000E-03 loss: 	0.42384 loss align 0.0000
2
starting val epoch 2
val [0002 / 0050] validation loss: 	0.42880
starting train epoch 2
 epoch [0002 / 0050] [0009/280] eta: 0 Days 1:15:53        lr: 	1.0000E-03 loss: 	0.49270 loss align 0.0000
 epoch [0002 / 0050] [0109/280] eta: 0 Days 1:11:48        lr: 	1.0000E-03 loss: 	0.40566 loss align 0.0000
 epoch [0002 / 0050] [0209/280] eta: 0 Days 1:9:6          lr: 	1.0000E-03 loss: 	0.41944 loss align 0.0000
3
starting val epoch 3
val [0003 / 0050] validation loss: 	0.42537
starting train epoch 3
 epoch [0003 / 0050] [0009/280] eta: 0 Days 1:10:28        lr: 	1.0000E-03 loss: 	0.47417 loss align 0.0000
 epoch [0003 / 0050] [0109/280] eta: 0 Days 1:8:16         lr: 	1.0000E-03 loss: 	0.42283 loss align 0.0000
 epoch [0003 / 0050] [0209/280] eta: 0 Days 1:6:20         lr: 	1.0000E-03 loss: 	0.42331 loss align 0.0000
4
starting val epoch 4
val [0004 / 0050] validation loss: 	0.42868
starting train epoch 4
 epoch [0004 / 0050] [0009/280] eta: 0 Days 1:8:11         lr: 	1.0000E-03 loss: 	0.55045 loss align 0.0000
 epoch [0004 / 0050] [0109/280] eta: 0 Days 1:6:0          lr: 	1.0000E-03 loss: 	0.43099 loss align 0.0000
 epoch [0004 / 0050] [0209/280] eta: 0 Days 1:4:44         lr: 	1.0000E-03 loss: 	0.42335 loss align 0.0000
5
starting val epoch 5
val [0005 / 0050] validation loss: 	0.41528
checkpoint
starting train epoch 5
 epoch [0005 / 0050] [0009/280] eta: 0 Days 1:6:23         lr: 	1.0000E-03 loss: 	0.42612 loss align 0.0000
 epoch [0005 / 0050] [0109/280] eta: 0 Days 1:4:57         lr: 	1.0000E-03 loss: 	0.40028 loss align 0.0000
 epoch [0005 / 0050] [0209/280] eta: 0 Days 1:3:43         lr: 	1.0000E-03 loss: 	0.39641 loss align 0.0000
6
starting val epoch 6
val [0006 / 0050] validation loss: 	0.42609
checkpoint
starting train epoch 6
 epoch [0006 / 0050] [0009/280] eta: 0 Days 1:4:46         lr: 	1.0000E-03 loss: 	0.45963 loss align 0.0000
 epoch [0006 / 0050] [0109/280] eta: 0 Days 1:3:23         lr: 	1.0000E-03 loss: 	0.40618 loss align 0.0000
 epoch [0006 / 0050] [0209/280] eta: 0 Days 1:2:2          lr: 	1.0000E-03 loss: 	0.40053 loss align 0.0000
7
starting val epoch 7
val [0007 / 0050] validation loss: 	0.40703
starting train epoch 7
 epoch [0007 / 0050] [0009/280] eta: 0 Days 1:2:28         lr: 	1.0000E-03 loss: 	0.43994 loss align 0.0000
 epoch [0007 / 0050] [0109/280] eta: 0 Days 1:1:27         lr: 	1.0000E-03 loss: 	0.41570 loss align 0.0000
 epoch [0007 / 0050] [0209/280] eta: 0 Days 1:0:14         lr: 	1.0000E-03 loss: 	0.39538 loss align 0.0000
8
starting val epoch 8
val [0008 / 0050] validation loss: 	0.42331
starting train epoch 8
 epoch [0008 / 0050] [0009/280] eta: 0 Days 1:0:33         lr: 	1.0000E-03 loss: 	0.31957 loss align 0.0000
 epoch [0008 / 0050] [0109/280] eta: 0 Days 0:59:22        lr: 	1.0000E-03 loss: 	0.42014 loss align 0.0000
 epoch [0008 / 0050] [0209/280] eta: 0 Days 0:58:21        lr: 	1.0000E-03 loss: 	0.42055 loss align 0.0000
9
starting val epoch 9
val [0009 / 0050] validation loss: 	0.42757
starting train epoch 9
 epoch [0009 / 0050] [0009/280] eta: 0 Days 0:58:28        lr: 	1.0000E-03 loss: 	0.39351 loss align 0.0000
 epoch [0009 / 0050] [0109/280] eta: 0 Days 0:57:28        lr: 	1.0000E-03 loss: 	0.42814 loss align 0.0000
 epoch [0009 / 0050] [0209/280] eta: 0 Days 0:56:31        lr: 	1.0000E-03 loss: 	0.42890 loss align 0.0000
10
starting val epoch 10
val [0010 / 0050] validation loss: 	0.42432
starting train epoch 10
 epoch [0010 / 0050] [0009/280] eta: 0 Days 0:56:33        lr: 	1.0000E-03 loss: 	0.48634 loss align 0.0000
 epoch [0010 / 0050] [0109/280] eta: 0 Days 0:55:32        lr: 	1.0000E-03 loss: 	0.42279 loss align 0.0000
 epoch [0010 / 0050] [0209/280] eta: 0 Days 0:54:41        lr: 	1.0000E-03 loss: 	0.42741 loss align 0.0000
11
starting val epoch 11
val [0011 / 0050] validation loss: 	0.43478
starting train epoch 11
 epoch [0011 / 0050] [0009/280] eta: 0 Days 0:54:39        lr: 	1.0000E-03 loss: 	0.56001 loss align 0.0000
 epoch [0011 / 0050] [0109/280] eta: 0 Days 0:53:52        lr: 	1.0000E-03 loss: 	0.43162 loss align 0.0000
 epoch [0011 / 0050] [0209/280] eta: 0 Days 0:53:6         lr: 	1.0000E-03 loss: 	0.41946 loss align 0.0000
12
starting val epoch 12
val [0012 / 0050] validation loss: 	0.42697
starting train epoch 12
 epoch [0012 / 0050] [0009/280] eta: 0 Days 0:53:10        lr: 	1.0000E-03 loss: 	0.40214 loss align 0.0000
 epoch [0012 / 0050] [0109/280] eta: 0 Days 0:52:28        lr: 	1.0000E-03 loss: 	0.41833 loss align 0.0000
 epoch [0012 / 0050] [0209/280] eta: 0 Days 0:51:38        lr: 	1.0000E-03 loss: 	0.41744 loss align 0.0000
13
starting val epoch 13
val [0013 / 0050] validation loss: 	0.43595
starting train epoch 13
 epoch [0013 / 0050] [0009/280] eta: 0 Days 0:51:36        lr: 	1.0000E-03 loss: 	0.47443 loss align 0.0000
 epoch [0013 / 0050] [0109/280] eta: 0 Days 0:50:48        lr: 	1.0000E-03 loss: 	0.40762 loss align 0.0000
 epoch [0013 / 0050] [0209/280] eta: 0 Days 0:50:4         lr: 	1.0000E-03 loss: 	0.42390 loss align 0.0000
14
starting val epoch 14
val [0014 / 0050] validation loss: 	0.42767
starting train epoch 14
 epoch [0014 / 0050] [0009/280] eta: 0 Days 0:49:57        lr: 	1.0000E-03 loss: 	0.43413 loss align 0.0000
 epoch [0014 / 0050] [0109/280] eta: 0 Days 0:49:12        lr: 	1.0000E-03 loss: 	0.42813 loss align 0.0000
 epoch [0014 / 0050] [0209/280] eta: 0 Days 0:48:27        lr: 	1.0000E-03 loss: 	0.42078 loss align 0.0000
15
starting val epoch 15
val [0015 / 0050] validation loss: 	0.42490
starting train epoch 15
 epoch [0015 / 0050] [0009/280] eta: 0 Days 0:48:29        lr: 	1.0000E-03 loss: 	0.42292 loss align 0.0000
 epoch [0015 / 0050] [0109/280] eta: 0 Days 0:47:45        lr: 	1.0000E-03 loss: 	0.42629 loss align 0.0000
 epoch [0015 / 0050] [0209/280] eta: 0 Days 0:47:6         lr: 	1.0000E-03 loss: 	0.42247 loss align 0.0000
16
starting val epoch 16
val [0016 / 0050] validation loss: 	0.42509
starting train epoch 16
 epoch [0016 / 0050] [0009/280] eta: 0 Days 0:47:2         lr: 	1.0000E-03 loss: 	0.51850 loss align 0.0000
 epoch [0016 / 0050] [0109/280] eta: 0 Days 0:46:23        lr: 	1.0000E-03 loss: 	0.43163 loss align 0.0000
 epoch [0016 / 0050] [0209/280] eta: 0 Days 0:45:41        lr: 	1.0000E-03 loss: 	0.43104 loss align 0.0000
17
starting val epoch 17
val [0017 / 0050] validation loss: 	0.42511
starting train epoch 17
 epoch [0017 / 0050] [0009/280] eta: 0 Days 0:45:32        lr: 	1.0000E-03 loss: 	0.51652 loss align 0.0000
 epoch [0017 / 0050] [0109/280] eta: 0 Days 0:44:52        lr: 	1.0000E-03 loss: 	0.41531 loss align 0.0000
 epoch [0017 / 0050] [0209/280] eta: 0 Days 0:44:10        lr: 	1.0000E-03 loss: 	0.42266 loss align 0.0000
18
starting val epoch 18
val [0018 / 0050] validation loss: 	0.42432
starting train epoch 18
 epoch [0018 / 0050] [0009/280] eta: 0 Days 0:44:0         lr: 	1.0000E-03 loss: 	0.48688 loss align 0.0000
 epoch [0018 / 0050] [0109/280] eta: 0 Days 0:43:21        lr: 	1.0000E-03 loss: 	0.43885 loss align 0.0000
 epoch [0018 / 0050] [0209/280] eta: 0 Days 0:42:41        lr: 	1.0000E-03 loss: 	0.43851 loss align 0.0000
19
starting val epoch 19
val [0019 / 0050] validation loss: 	0.42986
starting train epoch 19
 epoch [0019 / 0050] [0009/280] eta: 0 Days 0:42:33        lr: 	1.0000E-03 loss: 	0.44412 loss align 0.0000
 epoch [0019 / 0050] [0109/280] eta: 0 Days 0:41:55        lr: 	1.0000E-03 loss: 	0.40478 loss align 0.0000
 epoch [0019 / 0050] [0209/280] eta: 0 Days 0:41:16        lr: 	1.0000E-03 loss: 	0.41508 loss align 0.0000
20
starting val epoch 20
val [0020 / 0050] validation loss: 	0.42637
starting train epoch 20
 epoch [0020 / 0050] [0009/280] eta: 0 Days 0:41:3         lr: 	1.0000E-03 loss: 	0.45969 loss align 0.0000
 epoch [0020 / 0050] [0109/280] eta: 0 Days 0:40:24        lr: 	1.0000E-03 loss: 	0.43876 loss align 0.0000
 epoch [0020 / 0050] [0209/280] eta: 0 Days 0:39:46        lr: 	1.0000E-03 loss: 	0.42583 loss align 0.0000
21
starting val epoch 21
val [0021 / 0050] validation loss: 	0.43329
starting val epoch 0
val [0000 / 0050] validation loss: 	0.43100
Acute and unspecified renal failure                                                        & 0.668(0.712, 0.618) & 0.319 (0.388, 0.258)
fused_ehr test  0   best mean auc :0.668 mean auprc 0.319
                    CI AUROC (0.618, 0.712) CI AUPRC (0.258, 0.388)
                     AUROC accute 0.668 mixed 0.668 chronic 0.668
                     AUROC accute CI (0.618, 0.712) mixed (0.618 , 0.712) chronic (0.618, 0.712)
                     AUPRC accute  0.319 mixed 0.319 chronic 0.319
                     AUPRC accute CI  (0.258, 0.388) mixed (0.258,  0.388) chronic (0.258, 0.388)