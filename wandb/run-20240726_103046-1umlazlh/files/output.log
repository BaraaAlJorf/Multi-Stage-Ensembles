Some weights of the model checkpoint at allenai/longformer-base-4096 were not used when initializing LongformerModel: ['lm_head.decoder.weight', 'lm_head.layer_norm.bias', 'lm_head.layer_norm.weight', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.bias']
- This IS expected if you are initializing LongformerModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LongformerModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at emilyalsentzer/Bio_ClinicalBERT were not used when initializing BertModel: ['cls.seq_relationship.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.seq_relationship.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
ehr loaded
cxr loaded
rr loaded
==> training
running for fusion_type late
0
starting val epoch 0
val [0000 / 0050] validation loss: 	0.86368
checkpoint
starting train epoch 0
 epoch [0000 / 0050] [0009/267] eta: 0 Days 16:26:33       lr: 	1.0000E-03 loss: 	1.07352
 epoch [0000 / 0050] [0109/267] eta: 0 Days 3:1:10         lr: 	1.0000E-03 loss: 	0.52931
 epoch [0000 / 0050] [0209/267] eta: 0 Days 2:23:29        lr: 	1.0000E-03 loss: 	0.45834
1
starting val epoch 1
val [0001 / 0050] validation loss: 	0.54869
checkpoint
starting train epoch 1
 epoch [0001 / 0050] [0009/267] eta: 0 Days 2:28:37        lr: 	1.0000E-03 loss: 	0.56445
 epoch [0001 / 0050] [0109/267] eta: 0 Days 2:14:40        lr: 	1.0000E-03 loss: 	0.40137
 epoch [0001 / 0050] [0209/267] eta: 0 Days 2:7:21         lr: 	1.0000E-03 loss: 	0.39828
2
starting val epoch 2
val [0002 / 0050] validation loss: 	0.39377
checkpoint
starting train epoch 2
 epoch [0002 / 0050] [0009/267] eta: 0 Days 2:11:12        lr: 	1.0000E-03 loss: 	0.41714
 epoch [0002 / 0050] [0109/267] eta: 0 Days 2:5:1          lr: 	1.0000E-03 loss: 	0.38188
 epoch [0002 / 0050] [0209/267] eta: 0 Days 2:0:24         lr: 	1.0000E-03 loss: 	0.38438
3
starting val epoch 3
val [0003 / 0050] validation loss: 	0.39592
checkpoint
starting train epoch 3
 epoch [0003 / 0050] [0009/267] eta: 0 Days 2:3:8          lr: 	1.0000E-03 loss: 	0.35522
 epoch [0003 / 0050] [0109/267] eta: 0 Days 1:59:9         lr: 	1.0000E-03 loss: 	0.37158
 epoch [0003 / 0050] [0209/267] eta: 0 Days 1:55:50        lr: 	1.0000E-03 loss: 	0.36916
4
starting val epoch 4
val [0004 / 0050] validation loss: 	0.40087
starting train epoch 4
 epoch [0004 / 0050] [0009/267] eta: 0 Days 1:57:5         lr: 	1.0000E-03 loss: 	0.33491
 epoch [0004 / 0050] [0109/267] eta: 0 Days 1:54:7         lr: 	1.0000E-03 loss: 	0.40604
 epoch [0004 / 0050] [0209/267] eta: 0 Days 1:51:38        lr: 	1.0000E-03 loss: 	0.38624
5
starting val epoch 5
val [0005 / 0050] validation loss: 	0.42284
starting train epoch 5
 epoch [0005 / 0050] [0009/267] eta: 0 Days 1:52:30        lr: 	1.0000E-03 loss: 	0.36869
 epoch [0005 / 0050] [0109/267] eta: 0 Days 1:50:7         lr: 	1.0000E-03 loss: 	0.37270
 epoch [0005 / 0050] [0209/267] eta: 0 Days 1:48:3         lr: 	1.0000E-03 loss: 	0.38315
6
starting val epoch 6
val [0006 / 0050] validation loss: 	0.41721
starting train epoch 6
 epoch [0006 / 0050] [0009/267] eta: 0 Days 1:48:43        lr: 	1.0000E-03 loss: 	0.47471
 epoch [0006 / 0050] [0109/267] eta: 0 Days 1:46:45        lr: 	1.0000E-03 loss: 	0.36030
 epoch [0006 / 0050] [0209/267] eta: 0 Days 1:44:51        lr: 	1.0000E-03 loss: 	0.37935
7
starting val epoch 7
val [0007 / 0050] validation loss: 	0.47604
starting train epoch 7
 epoch [0007 / 0050] [0009/267] eta: 0 Days 1:45:18        lr: 	1.0000E-03 loss: 	0.38191
 epoch [0007 / 0050] [0109/267] eta: 0 Days 1:43:29        lr: 	1.0000E-03 loss: 	0.37920
 epoch [0007 / 0050] [0209/267] eta: 0 Days 1:41:52        lr: 	1.0000E-03 loss: 	0.37753
8
starting val epoch 8
val [0008 / 0050] validation loss: 	0.39396
starting train epoch 8
 epoch [0008 / 0050] [0009/267] eta: 0 Days 1:42:11        lr: 	1.0000E-03 loss: 	0.40088
 epoch [0008 / 0050] [0109/267] eta: 0 Days 1:40:30        lr: 	1.0000E-03 loss: 	0.36890
 epoch [0008 / 0050] [0209/267] eta: 0 Days 1:38:56        lr: 	1.0000E-03 loss: 	0.36582
9
starting val epoch 9
val [0009 / 0050] validation loss: 	0.46333
starting train epoch 9
 epoch [0009 / 0050] [0009/267] eta: 0 Days 1:39:12        lr: 	1.0000E-03 loss: 	0.37019
 epoch [0009 / 0050] [0109/267] eta: 0 Days 1:37:42        lr: 	1.0000E-03 loss: 	0.36778
 epoch [0009 / 0050] [0209/267] eta: 0 Days 1:36:13        lr: 	1.0000E-03 loss: 	0.37221
10
starting val epoch 10
val [0010 / 0050] validation loss: 	0.45765
starting train epoch 10
 epoch [0010 / 0050] [0009/267] eta: 0 Days 1:36:19        lr: 	1.0000E-03 loss: 	0.53412
 epoch [0010 / 0050] [0109/267] eta: 0 Days 1:34:56        lr: 	1.0000E-03 loss: 	0.37878
 epoch [0010 / 0050] [0209/267] eta: 0 Days 1:33:33        lr: 	1.0000E-03 loss: 	0.36958
11
starting val epoch 11
val [0011 / 0050] validation loss: 	0.40570
starting train epoch 11
 epoch [0011 / 0050] [0009/267] eta: 0 Days 1:33:37        lr: 	1.0000E-03 loss: 	0.45483
 epoch [0011 / 0050] [0109/267] eta: 0 Days 1:32:15        lr: 	1.0000E-03 loss: 	0.38371
 epoch [0011 / 0050] [0209/267] eta: 0 Days 1:31:1         lr: 	1.0000E-03 loss: 	0.36395
12
starting val epoch 12
val [0012 / 0050] validation loss: 	0.40968
starting train epoch 12
 epoch [0012 / 0050] [0009/267] eta: 0 Days 1:31:2         lr: 	1.0000E-03 loss: 	0.47322
 epoch [0012 / 0050] [0109/267] eta: 0 Days 1:29:43        lr: 	1.0000E-03 loss: 	0.37943
 epoch [0012 / 0050] [0209/267] eta: 0 Days 1:28:27        lr: 	1.0000E-03 loss: 	0.39046
13
starting val epoch 13
val [0013 / 0050] validation loss: 	0.40299
starting train epoch 13
 epoch [0013 / 0050] [0009/267] eta: 0 Days 1:28:25        lr: 	1.0000E-03 loss: 	0.22971
 epoch [0013 / 0050] [0109/267] eta: 0 Days 1:27:9         lr: 	1.0000E-03 loss: 	0.37768
 epoch [0013 / 0050] [0209/267] eta: 0 Days 1:25:54        lr: 	1.0000E-03 loss: 	0.38546
14
starting val epoch 14
val [0014 / 0050] validation loss: 	0.45229
starting train epoch 14
 epoch [0014 / 0050] [0009/267] eta: 0 Days 1:25:50        lr: 	1.0000E-03 loss: 	0.47372
 epoch [0014 / 0050] [0109/267] eta: 0 Days 1:24:39        lr: 	1.0000E-03 loss: 	0.40817
 epoch [0014 / 0050] [0209/267] eta: 0 Days 1:23:28        lr: 	1.0000E-03 loss: 	0.38477
15
starting val epoch 15
val [0015 / 0050] validation loss: 	0.40799
starting train epoch 15
 epoch [0015 / 0050] [0009/267] eta: 0 Days 1:23:19        lr: 	1.0000E-03 loss: 	0.31655
 epoch [0015 / 0050] [0109/267] eta: 0 Days 1:22:8         lr: 	1.0000E-03 loss: 	0.35948
 epoch [0015 / 0050] [0209/267] eta: 0 Days 1:20:58        lr: 	1.0000E-03 loss: 	0.36012
16
starting val epoch 16
val [0016 / 0050] validation loss: 	0.45133
starting train epoch 16
 epoch [0016 / 0050] [0009/267] eta: 0 Days 1:20:47        lr: 	1.0000E-03 loss: 	0.42934
 epoch [0016 / 0050] [0109/267] eta: 0 Days 1:19:39        lr: 	1.0000E-03 loss: 	0.37081
 epoch [0016 / 0050] [0209/267] eta: 0 Days 1:18:32        lr: 	1.0000E-03 loss: 	0.37317
17
starting val epoch 17
val [0017 / 0050] validation loss: 	0.40712
starting train epoch 17
 epoch [0017 / 0050] [0009/267] eta: 0 Days 1:18:18        lr: 	1.0000E-03 loss: 	0.39747
 epoch [0017 / 0050] [0109/267] eta: 0 Days 1:17:11        lr: 	1.0000E-03 loss: 	0.34604
 epoch [0017 / 0050] [0209/267] eta: 0 Days 1:16:4         lr: 	1.0000E-03 loss: 	0.37445
18
starting val epoch 18
val [0018 / 0050] validation loss: 	0.40798
starting val epoch 0
val [0000 / 0050] validation loss: 	0.38054
Acute and unspecified renal failure                                                        & 0.752(0.791, 0.711) & 0.353 (0.431, 0.289)
fused_ehr test  0   best mean auc :0.752 mean auprc 0.353
                    CI AUROC (0.711, 0.791) CI AUPRC (0.289, 0.431)
                     AUROC accute 0.752 mixed 0.752 chronic 0.752
                     AUROC accute CI (0.711, 0.791) mixed (0.711 , 0.791) chronic (0.711, 0.791)
                     AUPRC accute  0.353 mixed 0.353 chronic 0.353
                     AUPRC accute CI  (0.289, 0.431) mixed (0.289,  0.431) chronic (0.289, 0.431)