Some weights of the model checkpoint at allenai/longformer-base-4096 were not used when initializing LongformerModel: ['lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.dense.weight', 'lm_head.bias', 'lm_head.decoder.weight']
- This IS expected if you are initializing LongformerModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LongformerModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at emilyalsentzer/Bio_ClinicalBERT were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.predictions.bias', 'cls.seq_relationship.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
ehr loaded
cxr loaded
rr loaded
==> training
running for fusion_type fused_ehr
0
starting val epoch 0
val [0000 / 0050] validation loss: 	0.98829
checkpoint
starting train epoch 0
 epoch [0000 / 0050] [0009/267] eta: 0 Days 17:3:59        lr: 	1.0000E-03 loss: 	0.95885 loss align 0.0000
 epoch [0000 / 0050] [0109/267] eta: 0 Days 3:17:59        lr: 	1.0000E-03 loss: 	0.46798 loss align 0.0000
 epoch [0000 / 0050] [0209/267] eta: 0 Days 2:37:56        lr: 	1.0000E-03 loss: 	0.44729 loss align 0.0000
1
starting val epoch 1
val [0001 / 0050] validation loss: 	0.45395
starting train epoch 1
 epoch [0001 / 0050] [0009/267] eta: 0 Days 2:40:29        lr: 	1.0000E-03 loss: 	0.50440 loss align 0.0000
 epoch [0001 / 0050] [0109/267] eta: 0 Days 2:27:20        lr: 	1.0000E-03 loss: 	0.43198 loss align 0.0000
 epoch [0001 / 0050] [0209/267] eta: 0 Days 2:19:25        lr: 	1.0000E-03 loss: 	0.42704 loss align 0.0000
2
starting val epoch 2
val [0002 / 0050] validation loss: 	0.48074
checkpoint
starting train epoch 2
 epoch [0002 / 0050] [0009/267] eta: 0 Days 2:24:0         lr: 	1.0000E-03 loss: 	0.54353 loss align 0.0000
 epoch [0002 / 0050] [0109/267] eta: 0 Days 2:18:8         lr: 	1.0000E-03 loss: 	0.42235 loss align 0.0000
 epoch [0002 / 0050] [0209/267] eta: 0 Days 2:13:31        lr: 	1.0000E-03 loss: 	0.43048 loss align 0.0000
3
starting val epoch 3
val [0003 / 0050] validation loss: 	0.43657
starting train epoch 3
 epoch [0003 / 0050] [0009/267] eta: 0 Days 2:15:26        lr: 	1.0000E-03 loss: 	0.49539 loss align 0.0000
 epoch [0003 / 0050] [0109/267] eta: 0 Days 2:11:38        lr: 	1.0000E-03 loss: 	0.42648 loss align 0.0000
 epoch [0003 / 0050] [0209/267] eta: 0 Days 2:8:20         lr: 	1.0000E-03 loss: 	0.42697 loss align 0.0000
4
starting val epoch 4
val [0004 / 0050] validation loss: 	0.43627
starting train epoch 4
 epoch [0004 / 0050] [0009/267] eta: 0 Days 2:9:47         lr: 	1.0000E-03 loss: 	0.42300 loss align 0.0000
 epoch [0004 / 0050] [0109/267] eta: 0 Days 2:6:56         lr: 	1.0000E-03 loss: 	0.41981 loss align 0.0000
 epoch [0004 / 0050] [0209/267] eta: 0 Days 2:4:22         lr: 	1.0000E-03 loss: 	0.42583 loss align 0.0000
5
starting val epoch 5
val [0005 / 0050] validation loss: 	0.43805
starting train epoch 5
 epoch [0005 / 0050] [0009/267] eta: 0 Days 2:5:13         lr: 	1.0000E-03 loss: 	0.53556 loss align 0.0000
 epoch [0005 / 0050] [0109/267] eta: 0 Days 2:2:50         lr: 	1.0000E-03 loss: 	0.42464 loss align 0.0000
 epoch [0005 / 0050] [0209/267] eta: 0 Days 2:0:35         lr: 	1.0000E-03 loss: 	0.42509 loss align 0.0000
6
starting val epoch 6
val [0006 / 0050] validation loss: 	0.43593
starting train epoch 6
 epoch [0006 / 0050] [0009/267] eta: 0 Days 2:1:20         lr: 	1.0000E-03 loss: 	0.51986 loss align 0.0000
 epoch [0006 / 0050] [0109/267] eta: 0 Days 1:59:11        lr: 	1.0000E-03 loss: 	0.43280 loss align 0.0000
 epoch [0006 / 0050] [0209/267] eta: 0 Days 1:57:16        lr: 	1.0000E-03 loss: 	0.42344 loss align 0.0000
7
starting val epoch 7
val [0007 / 0050] validation loss: 	0.43587
starting train epoch 7
 epoch [0007 / 0050] [0009/267] eta: 0 Days 1:57:47        lr: 	1.0000E-03 loss: 	0.48237 loss align 0.0000
 epoch [0007 / 0050] [0109/267] eta: 0 Days 1:55:58        lr: 	1.0000E-03 loss: 	0.42794 loss align 0.0000
 epoch [0007 / 0050] [0209/267] eta: 0 Days 1:54:7         lr: 	1.0000E-03 loss: 	0.42301 loss align 0.0000
8
starting val epoch 8
val [0008 / 0050] validation loss: 	0.43692
starting train epoch 8
 epoch [0008 / 0050] [0009/267] eta: 0 Days 1:54:30        lr: 	1.0000E-03 loss: 	0.47313 loss align 0.0000
 epoch [0008 / 0050] [0109/267] eta: 0 Days 1:52:47        lr: 	1.0000E-03 loss: 	0.43889 loss align 0.0000
 epoch [0008 / 0050] [0209/267] eta: 0 Days 1:51:5         lr: 	1.0000E-03 loss: 	0.42411 loss align 0.0000
9
starting val epoch 9
val [0009 / 0050] validation loss: 	0.43549
starting train epoch 9
 epoch [0009 / 0050] [0009/267] eta: 0 Days 1:51:17        lr: 	1.0000E-03 loss: 	0.51173 loss align 0.0000
 epoch [0009 / 0050] [0109/267] eta: 0 Days 1:49:39        lr: 	1.0000E-03 loss: 	0.42447 loss align 0.0000
 epoch [0009 / 0050] [0209/267] eta: 0 Days 1:48:5         lr: 	1.0000E-03 loss: 	0.41824 loss align 0.0000
10
starting val epoch 10
val [0010 / 0050] validation loss: 	0.43549
starting train epoch 10
 epoch [0010 / 0050] [0009/267] eta: 0 Days 1:48:14        lr: 	1.0000E-03 loss: 	0.42502 loss align 0.0000
 epoch [0010 / 0050] [0109/267] eta: 0 Days 1:46:41        lr: 	1.0000E-03 loss: 	0.42936 loss align 0.0000
 epoch [0010 / 0050] [0209/267] eta: 0 Days 1:45:11        lr: 	1.0000E-03 loss: 	0.42563 loss align 0.0000
11
starting val epoch 11
val [0011 / 0050] validation loss: 	0.43990
starting train epoch 11
 epoch [0011 / 0050] [0009/267] eta: 0 Days 1:45:13        lr: 	1.0000E-03 loss: 	0.49323 loss align 0.0000
 epoch [0011 / 0050] [0109/267] eta: 0 Days 1:43:44        lr: 	1.0000E-03 loss: 	0.44770 loss align 0.0000
 epoch [0011 / 0050] [0209/267] eta: 0 Days 1:42:20        lr: 	1.0000E-03 loss: 	0.42984 loss align 0.0000
12
starting val epoch 12
val [0012 / 0050] validation loss: 	0.43779
starting train epoch 12
 epoch [0012 / 0050] [0009/267] eta: 0 Days 1:42:19        lr: 	1.0000E-03 loss: 	0.45250 loss align 0.0000
 epoch [0012 / 0050] [0109/267] eta: 0 Days 1:40:56        lr: 	1.0000E-03 loss: 	0.40734 loss align 0.0000
 epoch [0012 / 0050] [0209/267] eta: 0 Days 1:39:32        lr: 	1.0000E-03 loss: 	0.41523 loss align 0.0000
13
starting val epoch 13
val [0013 / 0050] validation loss: 	0.43551
starting train epoch 13
 epoch [0013 / 0050] [0009/267] eta: 0 Days 1:39:26        lr: 	1.0000E-03 loss: 	0.41967 loss align 0.0000
 epoch [0013 / 0050] [0109/267] eta: 0 Days 1:38:4         lr: 	1.0000E-03 loss: 	0.42005 loss align 0.0000
 epoch [0013 / 0050] [0209/267] eta: 0 Days 1:36:43        lr: 	1.0000E-03 loss: 	0.42008 loss align 0.0000
14
starting val epoch 14
val [0014 / 0050] validation loss: 	0.43549
starting train epoch 14
 epoch [0014 / 0050] [0009/267] eta: 0 Days 1:36:35        lr: 	1.0000E-03 loss: 	0.42888 loss align 0.0000
 epoch [0014 / 0050] [0109/267] eta: 0 Days 1:35:17        lr: 	1.0000E-03 loss: 	0.41715 loss align 0.0000
 epoch [0014 / 0050] [0209/267] eta: 0 Days 1:33:57        lr: 	1.0000E-03 loss: 	0.41779 loss align 0.0000
15
starting val epoch 15
val [0015 / 0050] validation loss: 	0.43835
starting train epoch 15
 epoch [0015 / 0050] [0009/267] eta: 0 Days 1:33:47        lr: 	1.0000E-03 loss: 	0.50716 loss align 0.0000
 epoch [0015 / 0050] [0109/267] eta: 0 Days 1:32:29        lr: 	1.0000E-03 loss: 	0.44874 loss align 0.0000
 epoch [0015 / 0050] [0209/267] eta: 0 Days 1:31:12        lr: 	1.0000E-03 loss: 	0.43472 loss align 0.0000
16
starting val epoch 16
val [0016 / 0050] validation loss: 	0.44583
starting train epoch 16
 epoch [0016 / 0050] [0009/267] eta: 0 Days 1:30:59        lr: 	1.0000E-03 loss: 	0.37735 loss align 0.0000
 epoch [0016 / 0050] [0109/267] eta: 0 Days 1:29:44        lr: 	1.0000E-03 loss: 	0.42716 loss align 0.0000
 epoch [0016 / 0050] [0209/267] eta: 0 Days 1:28:28        lr: 	1.0000E-03 loss: 	0.41836 loss align 0.0000
17
starting val epoch 17
val [0017 / 0050] validation loss: 	0.43555
starting val epoch 0
val [0000 / 0050] validation loss: 	0.47493
Acute and unspecified renal failure                                                        & 0.484(0.529, 0.439) & 0.145 (0.171, 0.124)
fused_ehr test  0   best mean auc :0.484 mean auprc 0.145
                    CI AUROC (0.439, 0.529) CI AUPRC (0.124, 0.171)
                     AUROC accute 0.484 mixed 0.484 chronic 0.484
                     AUROC accute CI (0.439, 0.529) mixed (0.439 , 0.529) chronic (0.439, 0.529)
                     AUPRC accute  0.145 mixed 0.145 chronic 0.145
                     AUPRC accute CI  (0.124, 0.171) mixed (0.124,  0.171) chronic (0.124, 0.171)