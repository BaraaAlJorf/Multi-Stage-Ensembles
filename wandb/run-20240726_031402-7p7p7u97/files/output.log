Some weights of the model checkpoint at allenai/longformer-base-4096 were not used when initializing LongformerModel: ['lm_head.layer_norm.weight', 'lm_head.decoder.weight', 'lm_head.layer_norm.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.bias']
- This IS expected if you are initializing LongformerModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LongformerModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at emilyalsentzer/Bio_ClinicalBERT were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.weight', 'cls.predictions.bias', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.LayerNorm.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
ehr loaded
cxr loaded
==> training
running for fusion_type fused_ehr
0
starting val epoch 0
val [0000 / 0050] validation loss: 	0.84791
checkpoint
starting train epoch 0
 epoch [0000 / 0050] [0009/280] eta: 0 Days 14:35:12       lr: 	1.0000E-04 loss: 	0.46288 loss align 0.0000
 epoch [0000 / 0050] [0109/280] eta: 0 Days 2:9:32         lr: 	1.0000E-04 loss: 	0.44163 loss align 0.0000
 epoch [0000 / 0050] [0209/280] eta: 0 Days 1:34:27        lr: 	1.0000E-04 loss: 	0.40811 loss align 0.0000
1
starting val epoch 1
val [0001 / 0050] validation loss: 	0.39200
checkpoint
starting train epoch 1
 epoch [0001 / 0050] [0009/280] eta: 0 Days 1:35:48        lr: 	1.0000E-04 loss: 	0.43010 loss align 0.0000
 epoch [0001 / 0050] [0109/280] eta: 0 Days 1:25:54        lr: 	1.0000E-04 loss: 	0.35788 loss align 0.0000
 epoch [0001 / 0050] [0209/280] eta: 0 Days 1:19:17        lr: 	1.0000E-04 loss: 	0.35416 loss align 0.0000
2
starting val epoch 2
val [0002 / 0050] validation loss: 	0.43942
checkpoint
starting train epoch 2
 epoch [0002 / 0050] [0009/280] eta: 0 Days 1:21:39        lr: 	1.0000E-04 loss: 	0.47902 loss align 0.0000
 epoch [0002 / 0050] [0109/280] eta: 0 Days 1:17:19        lr: 	1.0000E-04 loss: 	0.33595 loss align 0.0000
 epoch [0002 / 0050] [0209/280] eta: 0 Days 1:13:58        lr: 	1.0000E-04 loss: 	0.34432 loss align 0.0000
3
starting val epoch 3
val [0003 / 0050] validation loss: 	0.34325
checkpoint
starting train epoch 3
 epoch [0003 / 0050] [0009/280] eta: 0 Days 1:15:48        lr: 	1.0000E-04 loss: 	0.37014 loss align 0.0000
 epoch [0003 / 0050] [0109/280] eta: 0 Days 1:12:57        lr: 	1.0000E-04 loss: 	0.33720 loss align 0.0000
 epoch [0003 / 0050] [0209/280] eta: 0 Days 1:10:21        lr: 	1.0000E-04 loss: 	0.33872 loss align 0.0000
4
starting val epoch 4
val [0004 / 0050] validation loss: 	0.35823
starting train epoch 4
 epoch [0004 / 0050] [0009/280] eta: 0 Days 1:11:6         lr: 	1.0000E-04 loss: 	0.35817 loss align 0.0000
 epoch [0004 / 0050] [0109/280] eta: 0 Days 1:9:0          lr: 	1.0000E-04 loss: 	0.31497 loss align 0.0000
 epoch [0004 / 0050] [0209/280] eta: 0 Days 1:7:12         lr: 	1.0000E-04 loss: 	0.31944 loss align 0.0000
5
starting val epoch 5
val [0005 / 0050] validation loss: 	0.34652
starting train epoch 5
 epoch [0005 / 0050] [0009/280] eta: 0 Days 1:7:46         lr: 	1.0000E-04 loss: 	0.32685 loss align 0.0000
 epoch [0005 / 0050] [0109/280] eta: 0 Days 1:6:16         lr: 	1.0000E-04 loss: 	0.32925 loss align 0.0000
 epoch [0005 / 0050] [0209/280] eta: 0 Days 1:4:47         lr: 	1.0000E-04 loss: 	0.31410 loss align 0.0000
6
starting val epoch 6
val [0006 / 0050] validation loss: 	0.37138
checkpoint
starting train epoch 6
 epoch [0006 / 0050] [0009/280] eta: 0 Days 1:5:37         lr: 	1.0000E-04 loss: 	0.32414 loss align 0.0000
 epoch [0006 / 0050] [0109/280] eta: 0 Days 1:4:20         lr: 	1.0000E-04 loss: 	0.31810 loss align 0.0000
 epoch [0006 / 0050] [0209/280] eta: 0 Days 1:3:8          lr: 	1.0000E-04 loss: 	0.32208 loss align 0.0000
7
starting val epoch 7
val [0007 / 0050] validation loss: 	0.34314
checkpoint
starting train epoch 7
 epoch [0007 / 0050] [0009/280] eta: 0 Days 1:3:47         lr: 	1.0000E-04 loss: 	0.36119 loss align 0.0000
 epoch [0007 / 0050] [0109/280] eta: 0 Days 1:2:32         lr: 	1.0000E-04 loss: 	0.29718 loss align 0.0000
 epoch [0007 / 0050] [0209/280] eta: 0 Days 1:1:12         lr: 	1.0000E-04 loss: 	0.28896 loss align 0.0000
8
starting val epoch 8
val [0008 / 0050] validation loss: 	0.35097
starting train epoch 8
 epoch [0008 / 0050] [0009/280] eta: 0 Days 1:1:30         lr: 	1.0000E-04 loss: 	0.21242 loss align 0.0000
 epoch [0008 / 0050] [0109/280] eta: 0 Days 1:0:16         lr: 	1.0000E-04 loss: 	0.32091 loss align 0.0000
 epoch [0008 / 0050] [0209/280] eta: 0 Days 0:59:6         lr: 	1.0000E-04 loss: 	0.30215 loss align 0.0000
9
starting val epoch 9
val [0009 / 0050] validation loss: 	0.38813
starting train epoch 9
 epoch [0009 / 0050] [0009/280] eta: 0 Days 0:59:17        lr: 	1.0000E-04 loss: 	0.30853 loss align 0.0000
 epoch [0009 / 0050] [0109/280] eta: 0 Days 0:58:22        lr: 	1.0000E-04 loss: 	0.28673 loss align 0.0000
 epoch [0009 / 0050] [0209/280] eta: 0 Days 0:57:29        lr: 	1.0000E-04 loss: 	0.29508 loss align 0.0000
10
starting val epoch 10
val [0010 / 0050] validation loss: 	0.37063
starting train epoch 10
 epoch [0010 / 0050] [0009/280] eta: 0 Days 0:57:38        lr: 	1.0000E-04 loss: 	0.35256 loss align 0.0000
 epoch [0010 / 0050] [0109/280] eta: 0 Days 0:56:42        lr: 	1.0000E-04 loss: 	0.27349 loss align 0.0000
 epoch [0010 / 0050] [0209/280] eta: 0 Days 0:55:49        lr: 	1.0000E-04 loss: 	0.28219 loss align 0.0000
11
starting val epoch 11
val [0011 / 0050] validation loss: 	0.37166
starting train epoch 11
 epoch [0011 / 0050] [0009/280] eta: 0 Days 0:55:55        lr: 	1.0000E-04 loss: 	0.27308 loss align 0.0000
 epoch [0011 / 0050] [0109/280] eta: 0 Days 0:55:1         lr: 	1.0000E-04 loss: 	0.25431 loss align 0.0000
 epoch [0011 / 0050] [0209/280] eta: 0 Days 0:54:12        lr: 	1.0000E-04 loss: 	0.26633 loss align 0.0000
12
starting val epoch 12
val [0012 / 0050] validation loss: 	0.35979
starting train epoch 12
 epoch [0012 / 0050] [0009/280] eta: 0 Days 0:54:13        lr: 	1.0000E-04 loss: 	0.30849 loss align 0.0000
 epoch [0012 / 0050] [0109/280] eta: 0 Days 0:53:22        lr: 	1.0000E-04 loss: 	0.27490 loss align 0.0000
 epoch [0012 / 0050] [0209/280] eta: 0 Days 0:52:36        lr: 	1.0000E-04 loss: 	0.27203 loss align 0.0000
13
starting val epoch 13
val [0013 / 0050] validation loss: 	0.39043
starting train epoch 13
 epoch [0013 / 0050] [0009/280] eta: 0 Days 0:52:36        lr: 	1.0000E-04 loss: 	0.31664 loss align 0.0000
 epoch [0013 / 0050] [0109/280] eta: 0 Days 0:51:50        lr: 	1.0000E-04 loss: 	0.25767 loss align 0.0000
 epoch [0013 / 0050] [0209/280] eta: 0 Days 0:51:2         lr: 	1.0000E-04 loss: 	0.26382 loss align 0.0000
14
starting val epoch 14
val [0014 / 0050] validation loss: 	0.38336
starting train epoch 14
 epoch [0014 / 0050] [0009/280] eta: 0 Days 0:50:59        lr: 	1.0000E-04 loss: 	0.31327 loss align 0.0000
 epoch [0014 / 0050] [0109/280] eta: 0 Days 0:50:15        lr: 	1.0000E-04 loss: 	0.25514 loss align 0.0000
 epoch [0014 / 0050] [0209/280] eta: 0 Days 0:49:30        lr: 	1.0000E-04 loss: 	0.25471 loss align 0.0000
15
starting val epoch 15
val [0015 / 0050] validation loss: 	0.36063
starting train epoch 15
 epoch [0015 / 0050] [0009/280] eta: 0 Days 0:49:25        lr: 	1.0000E-04 loss: 	0.18579 loss align 0.0000
 epoch [0015 / 0050] [0109/280] eta: 0 Days 0:48:42        lr: 	1.0000E-04 loss: 	0.24707 loss align 0.0000
 epoch [0015 / 0050] [0209/280] eta: 0 Days 0:48:0         lr: 	1.0000E-04 loss: 	0.24640 loss align 0.0000
16
starting val epoch 16
val [0016 / 0050] validation loss: 	0.36825
starting train epoch 16
 epoch [0016 / 0050] [0009/280] eta: 0 Days 0:47:53        lr: 	1.0000E-04 loss: 	0.26459 loss align 0.0000
 epoch [0016 / 0050] [0109/280] eta: 0 Days 0:47:10        lr: 	1.0000E-04 loss: 	0.23939 loss align 0.0000
 epoch [0016 / 0050] [0209/280] eta: 0 Days 0:46:28        lr: 	1.0000E-04 loss: 	0.24490 loss align 0.0000
17
starting val epoch 17
val [0017 / 0050] validation loss: 	0.40258
starting train epoch 17
 epoch [0017 / 0050] [0009/280] eta: 0 Days 0:46:21        lr: 	1.0000E-04 loss: 	0.18916 loss align 0.0000
 epoch [0017 / 0050] [0109/280] eta: 0 Days 0:45:41        lr: 	1.0000E-04 loss: 	0.23263 loss align 0.0000
 epoch [0017 / 0050] [0209/280] eta: 0 Days 0:45:2         lr: 	1.0000E-04 loss: 	0.24042 loss align 0.0000
18
starting val epoch 18
val [0018 / 0050] validation loss: 	0.41565
starting train epoch 18
 epoch [0018 / 0050] [0009/280] eta: 0 Days 0:44:53        lr: 	1.0000E-04 loss: 	0.31416 loss align 0.0000
 epoch [0018 / 0050] [0109/280] eta: 0 Days 0:44:15        lr: 	1.0000E-04 loss: 	0.25388 loss align 0.0000
 epoch [0018 / 0050] [0209/280] eta: 0 Days 0:43:35        lr: 	1.0000E-04 loss: 	0.25006 loss align 0.0000
19
starting val epoch 19
val [0019 / 0050] validation loss: 	0.40245
starting train epoch 19
 epoch [0019 / 0050] [0009/280] eta: 0 Days 0:43:26        lr: 	1.0000E-04 loss: 	0.26794 loss align 0.0000
 epoch [0019 / 0050] [0109/280] eta: 0 Days 0:42:48        lr: 	1.0000E-04 loss: 	0.22001 loss align 0.0000
 epoch [0019 / 0050] [0209/280] eta: 0 Days 0:42:10        lr: 	1.0000E-04 loss: 	0.23017 loss align 0.0000
20
starting val epoch 20
val [0020 / 0050] validation loss: 	0.43152
starting train epoch 20
 epoch [0020 / 0050] [0009/280] eta: 0 Days 0:42:1         lr: 	1.0000E-04 loss: 	0.25748 loss align 0.0000
 epoch [0020 / 0050] [0109/280] eta: 0 Days 0:41:22        lr: 	1.0000E-04 loss: 	0.23759 loss align 0.0000
 epoch [0020 / 0050] [0209/280] eta: 0 Days 0:40:44        lr: 	1.0000E-04 loss: 	0.23945 loss align 0.0000
21
starting val epoch 21
val [0021 / 0050] validation loss: 	0.42059
starting train epoch 21
 epoch [0021 / 0050] [0009/280] eta: 0 Days 0:40:32        lr: 	1.0000E-04 loss: 	0.27013 loss align 0.0000
 epoch [0021 / 0050] [0109/280] eta: 0 Days 0:39:55        lr: 	1.0000E-04 loss: 	0.23160 loss align 0.0000
 epoch [0021 / 0050] [0209/280] eta: 0 Days 0:39:18        lr: 	1.0000E-04 loss: 	0.22099 loss align 0.0000
22
starting val epoch 22
val [0022 / 0050] validation loss: 	0.43289
starting val epoch 0
val [0000 / 0050] validation loss: 	0.35134
Acute and unspecified renal failure                                                        & 0.807(0.839, 0.772) & 0.454 (0.528, 0.386)
fused_ehr test  0   best mean auc :0.807 mean auprc 0.454
                    CI AUROC (0.772, 0.839) CI AUPRC (0.386, 0.528)
                     AUROC accute 0.807 mixed 0.807 chronic 0.807
                     AUROC accute CI (0.772, 0.839) mixed (0.772 , 0.839) chronic (0.772, 0.839)
                     AUPRC accute  0.454 mixed 0.454 chronic 0.454
                     AUPRC accute CI  (0.386, 0.528) mixed (0.386,  0.528) chronic (0.386, 0.528)